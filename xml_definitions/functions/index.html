<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.png">
        

	<title>Functions - Snom io Knowledge base</title>

        <link href="../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic,500,100,100italic' rel='stylesheet' type='text/css'>
        <link href="../../extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-1331074-26', 'auto');
            ga('send', 'pageview');
        </script>
        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="navbar-container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../.."><img height="70px" src="/img/knowledgebase.png" alt="site_name"/></a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">XML Minibrowser <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            
<li >
    <a href="../../xml_minibrowser/">Introduction</a>
</li>

                        
                        <!-- ORIG
                        <li >
                            <a href="../../xml_minibrowser/">Introduction</a>
                        </li>
                        -->
                    
                        
                            
    <li class="dropdown-submenu">
    <a>Main tags</a>
    <ul class="dropdown-menu">
        
            
                
<li >
    <a href="../../xml_minibrowser/main_tags/SnomIPPhoneMenu/">SnomIPPhoneMenu</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/main_tags/SnomIPPhoneDirectory/">SnomIPPhoneDirectory</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/main_tags/SnomIPPhoneText/">SnomIPPhoneText</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/main_tags/SnomIPPhoneImage/">SnomIPPhoneImage</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/main_tags/SnomIPPhoneImageFile/">SnomIPPhoneImageFile</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/main_tags/SnomIPPhoneInput/">SnomIPPhoneInput</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/main_tags/SnomIPPhoneBatch/">SnomIPPhoneBatch</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/main_tags/main_sub_tags/">Main Sub Tags</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/main_tags/MainAttributes/">Main Attributes</a>
</li>

            
        
    </ul>
  </li>

                        
                        <!-- ORIG
                        <li >
                            <a href="">Main tags</a>
                        </li>
                        -->
                    
                        
                            
    <li class="dropdown-submenu">
    <a>Callbacks</a>
    <ul class="dropdown-menu">
        
            
                
<li >
    <a href="../../xml_minibrowser/callbacks/">Introduction</a>
</li>

            
        
            
        
    </ul>
  </li>

                        
                        <!-- ORIG
                        <li >
                            <a href="">Callbacks</a>
                        </li>
                        -->
                    
                        
                            
    <li class="dropdown-submenu">
    <a>Fragments</a>
    <ul class="dropdown-menu">
        
            
                
<li >
    <a href="../../xml_minibrowser/fragments/">Introduction</a>
</li>

            
        
            
        
    </ul>
  </li>

                        
                        <!-- ORIG
                        <li >
                            <a href="">Fragments</a>
                        </li>
                        -->
                    
                        
                            
<li >
    <a href="../../xml_minibrowser/templates/">Builtin Templates</a>
</li>

                        
                        <!-- ORIG
                        <li >
                            <a href="../../xml_minibrowser/templates/">Builtin Templates</a>
                        </li>
                        -->
                    
                        
                            
    <li class="dropdown-submenu">
    <a>Examples</a>
    <ul class="dropdown-menu">
        
            
                
<li >
    <a href="../../xml_minibrowser/examples/">Introduction</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/examples/SnomIPPhoneText/">SnomIPPhoneText</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/examples/SnomIPPhoneMenu/">SnomIPPhoneMenu</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/examples/InputField/">InputField</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/examples/SnomIPPhoneDirectory/">SnomIPPhoneDirectory</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/examples/SnomIPPhoneInput/">SnomIPPhoneInput</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/examples/SnomIPPhoneImage/">SnomIPPhoneImage</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/examples/SnomIPPhoneImageFile/">SnomIPPhoneImageFile</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/examples/SnomIPPhoneBatch/">SnomIPPhoneBatch</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/examples/main_subelements/">Main sub elements</a>
</li>

            
        
            
                
<li >
    <a href="../../xml_minibrowser/examples/main_elements_attributes/">Main elements attributes</a>
</li>

            
        
    </ul>
  </li>

                        
                        <!-- ORIG
                        <li >
                            <a href="">Examples</a>
                        </li>
                        -->
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">XML Definitions <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            
<li >
    <a href="../">XML Definitions</a>
</li>

                        
                        <!-- ORIG
                        <li >
                            <a href="../">XML Definitions</a>
                        </li>
                        -->
                    
                        
                            
<li class="active">
    <a href="./">Functions</a>
</li>

                        
                        <!-- ORIG
                        <li class="active">
                            <a href="./">Functions</a>
                        </li>
                        -->
                    
                        
                            
<li >
    <a href="../replacement_plan/">Replacement plan</a>
</li>

                        
                        <!-- ORIG
                        <li >
                            <a href="../replacement_plan/">Replacement plan</a>
                        </li>
                        -->
                    
                        
                            
<li >
    <a href="../debug/">Debug</a>
</li>

                        
                        <!-- ORIG
                        <li >
                            <a href="../debug/">Debug</a>
                        </li>
                        -->
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Awesome Snom io <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            
<li >
    <a href="../../awesome/list/">The Awesome list</a>
</li>

                        
                        <!-- ORIG
                        <li >
                            <a href="../../awesome/list/">The Awesome list</a>
                        </li>
                        -->
                    
                        
                            
<li >
    <a href="../../awesome/howto-contribute/">How to contribute</a>
</li>

                        
                        <!-- ORIG
                        <li >
                            <a href="../../awesome/howto-contribute/">How to contribute</a>
                        </li>
                        -->
                    
                        
                            
<li >
    <a href="../../awesome/about/">About</a>
</li>

                        
                        <!-- ORIG
                        <li >
                            <a href="../../awesome/about/">About</a>
                        </li>
                        -->
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../replacement_plan/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/Snomio/Documentation">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>
                <div class="breadcrumb-container">
            <ol class="breadcrumb">
                
                    
                        
                            
                                <li>XML Definitions &raquo;</li>
                            
                        
                    

                    <li>Functions</li>
                
            </ol>
        </div>

        <div class="container">
            
                <div class="col-md-3">
                    <div class="bs-sidebar hidden-print affix well" role="complementary">
                            
                        <ul class="nav bs-sidenav">
                                    
            <li class="level1 active"><a href="#xml_definition_functions">XML Definition Functions</a></li>
            
                <li class="level2"><a href="#join">join</a></li>
            
                <li class="level2"><a href="#find_index">find_index</a></li>
            
        
                        </ul>
                    </div>
                </div>
            

            
                <div class="col-md-9" role="main">

<h1 id="xml_definition_functions">XML Definition Functions<a class="headerlink" href="#xml_definition_functions" title="Permanent link"> #</a></h1>
<p>At the moment there are two types of Function in the XML Definition Code.</p>
<ul>
<li><strong>join</strong> is used to combine multiple sources before assigning them to a variable/array</li>
<li><strong>find_index</strong> which allows us to determinate the index(s) of where a value(s) can be found in an array</li>
</ul>
<p>The <strong>function</strong> element is a part of the <strong>assign</strong> element container and has a <strong>name</strong> attribute where we write our type into (<strong>join</strong> or <strong>find_index</strong>). Also depending on the function there could be additional attributes.</p>
<h2 id="join">join<a class="headerlink" href="#join" title="Permanent link"> #</a></h2>
<p>Sometimes it is very useful to combine two values into one and to do so we are going to use the <strong>join</strong> function. We are going to take our Basic BLF example and add Labels to it so that we can change them:</p>
<pre class="code"><code class="language-xml">&lt;general type=&quot;BusyLampField&quot; identity=&quot;1&quot;/&gt;
&lt;initialization&gt;
    &lt;state value=&quot;off&quot;/&gt;
    &lt;array name='label' separator=',' value='Remote Extensions Name, caller'/&gt;
    &lt;array name='label_x' separator=',' value='5,5'/&gt;
    &lt;array name='label_y' separator=',' value='2,15'/&gt;
    &lt;array name='label_width' separator=',' value='74,95'/&gt;
    &lt;array name='label_height' separator=',' value='13,24'/&gt;
    &lt;array name='label_align' separator=',' value='left,center'/&gt;
    &lt;variable name=&quot;subscr_uri&quot; value=&quot;sip:548@pbx.local&quot;/&gt;
&lt;/initialization&gt;
&lt;subscription type=&quot;dialog&quot; to=&quot;&amp;lt;$(subscr_uri)&amp;gt;&quot; for=&quot;$(subscr_uri)&quot;/&gt;
&lt;NotifyParsingRules type=&quot;applies&quot;&gt; 
    &lt;level1 translates_to='OK'&gt;/dialog-info[@entity=&quot;$(subscr_uri)&quot;]&lt;/level1&gt; 
&lt;/NotifyParsingRules&gt; 
&lt;NotifyParsingRules type=&quot;state&quot;&gt;
    &lt;level1 translates_to=&quot;ringing&quot;&gt;/dialog-info/dialog/state[.=&quot;early&quot;]&lt;/level1&gt;
    &lt;level1-1 translates_to=&quot;calling&quot;&gt;/dialog-info/dialog[@direction=&quot;initiator&quot;]&lt;/level1-1&gt;
    &lt;level2 translates_to=&quot;ringing&quot;&gt;/dialog-info/dialog/state[.=&quot;proceeding&quot;]&lt;/level2&gt;
    &lt;level2-1 translates_to=&quot;calling&quot;&gt;/dialog-info/dialog[@direction=&quot;initiator&quot;]&lt;/level2-1&gt;
    &lt;level3 translates_to=&quot;in_a_call&quot;&gt;/dialog-info/dialog/state[.=&quot;confirmed&quot;]&lt;/level3&gt;
    &lt;level4 translates_to=&quot;offhook&quot;&gt;/dialog-info/dialog/state[.=&quot;trying&quot;]&lt;/level4&gt;
    &lt;level5 translates_to=&quot;free&quot;/&gt;
&lt;/NotifyParsingRules&gt;
&lt;NotifyParsingRules type=&quot;variable&quot; id=&quot;call_id&quot; state=&quot;ringing&quot;&gt; 
    &lt;level1 fetch_attribute=&quot;call-id&quot;&gt;/dialog-info/dialog[@call-id]&lt;/level1&gt; 
&lt;/NotifyParsingRules&gt; 
&lt;NotifyParsingRules type=&quot;variable&quot; id=&quot;remote_tag&quot; state=&quot;ringing&quot;&gt; 
    &lt;level1 fetch_attribute=&quot;remote-tag&quot;&gt;/dialog-info/dialog[@remote-tag]&lt;/level1&gt; 
&lt;/NotifyParsingRules&gt; 
&lt;NotifyParsingRules type=&quot;variable&quot; id=&quot;local_tag&quot; state=&quot;ringing&quot;&gt; 
    &lt;level1 fetch_attribute=&quot;local-tag&quot;&gt;/dialog-info/dialog[@local-tag]&lt;/level1&gt; 
&lt;/NotifyParsingRules&gt; 
&lt;NotifyParsingRules type=&quot;variable&quot; id=&quot;remote_uri&quot; state=&quot;ringing&quot;&gt; 
    &lt;level1 fetch_attribute=&quot;uri&quot;&gt;/dialog-info/dialog/remote/target[@uri]&lt;/level1&gt; 
&lt;/NotifyParsingRules&gt; 
&lt;NotifyParsingRules type=&quot;variable&quot; id=&quot;remote_name&quot; state=&quot;ringing&quot;&gt; 
    &lt;level1 fetch_attribute=&quot;display&quot;&gt;/dialog-info/dialog/remote/identity[@display]&lt;/level1&gt; 
&lt;/NotifyParsingRules&gt;
&lt;action&gt; 
    &lt;assign type=&quot;on notify&quot;&gt;
        &lt;source context=&quot;this entity&quot; id=&quot;remote_name&quot;/&gt;
        &lt;source context=&quot;this entity&quot; id=&quot;remote_uri&quot;/&gt;
        &lt;function name=&quot;join&quot; pattern=&quot;$(src0) Tel:$(src1)&quot;/&gt;
        &lt;destination context=&quot;this entity&quot; id=&quot;label[1]&quot;/&gt;
    &lt;/assign&gt;
    &lt;assign type=&quot;on notify&quot; states=&quot;free,offhook,calling&quot;&gt;
        &lt;source context=&quot;this entity&quot; id=&quot;state&quot;/&gt;
        &lt;destination context=&quot;this entity&quot; id=&quot;label[1]&quot;/&gt;
    &lt;/assign&gt;
    &lt;invite target=&quot;$(remote_name)&lt;$(remote_uri)&gt;&quot; when=&quot;on press&quot; state=&quot;ringing&quot; request_uri=&quot;$(remote_uri)&quot; replaces=&quot;$(call_id);to-tag=$(remote_tag);from-tag=$(local_tag)&quot;/&gt;
    &lt;invite target=&quot;$(subscr_uri)&quot; when=&quot;on press&quot;/&gt; 
&lt;/action&gt;</code></pre>


<p>We took our two variables we parsed before with our <strong>NotifyParsingRules</strong> and combined them to get a new value which we put in our second position in our label array. </p>
<p>The attribute <strong>pattern</strong> allow us to define how to combine the values we want, e.g:
<em>pattern="$(src0) Tel:$(src1)"</em>  would mean like this  <em>$(remote_name) Tel: $(remote_uri)</em></p>
<p>Of course you can have more sources which you would like to combine, the indexing of the (src) start always from the top one and it index is 0. Also if you have 4 sources the last one would be "src3".</p>
<h2 id="find_index">find_index<a class="headerlink" href="#find_index" title="Permanent link"> #</a></h2>
<p>Sometimes you have a value(s) (variable or array) and you would like to check if it already exists in an array. </p>
<p>For such cases we have the <strong>find_index</strong> function, it allows us to search for a value in an array and if it's exists there it also gives us its index in it. This might be helpful if we would like to change it later.</p>
<p>It also supports arrays and will allow you to search for each value from the first array in the second array and give you a new array with the indexes of all found values.</p>
<pre class="code"><code class="language-xml">&lt;assign when=&quot;on notify&quot;&gt;
&lt;source context=&quot;this entity&quot; id=&quot;uris[]&quot;/&gt;
&lt;source context=&quot;this entity&quot; id=&quot;full_uris[]&quot;/&gt;
&lt;function name=&quot;find_index&quot;/&gt;
&lt;destination context=&quot;this entity&quot; id=&quot;full_idx[]&quot;/&gt;
&lt;/assign&gt;</code></pre>


<p><em>On an incoming SIP NOTIFY message, check each value from my first source (uris) if it exist in my second source (full_uris) and if so write his position from the second source to my destination (full_idx)</em></p>
<p><strong>NOTE:</strong> The result (destination) array will always have the same number of positions like the first (top) source. And if one of the values from the first source is not found in the second source, the position in the result (destination) array will be filed with an empty value.</p></div>
            
        </div>

    <footer class="col-md-12">
        <hr>
        
        <center>Copyright © 2016 Snom Technology AG. All rights reserved.</center>
        
    </footer>


        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>